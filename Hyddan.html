<!DOCTYPE html>
<html>
<head>
    <title>Hyddan Dash.js Player</title>
    <style type="text/css">
        video
        {
            width: 640px;
            height: 480px;
        }
    </style>

    <!-- Libraries -->
    <script src="src/lib/dijon.js"></script>
    <script src="src/lib/base64.js"></script>
    <script src="src/lib/xml2json.js"></script>
    <script src="src/lib/objectiron.js"></script>
    <script src="src/lib/long.js"></script>
    <script src="src/lib/Math.js"></script>
    
    <!-- Player -->
    <script src="src/streaming/Hyddan.js"></script>
    <script src="src/streaming/extensions/StringExtensions.js"></script>
    <script src="src/streaming/MediaPlayer.js"></script>
    <script src="src/streaming/Context.js"></script>
    <script src="src/streaming/ErrorHandler.js"></script>
    <script src="src/streaming/utils/Capabilities.js"></script>
    <script src="src/streaming/utils/EventBus.js"></script>
    <script src="src/streaming/utils/Debug.js"></script>
    <script src="src/streaming/extensions/RequestModifierExtensions.js"></script>
    <script src="src/streaming/models/VideoModel.js"></script>
    <script src="src/streaming/vo/FragmentRequest.js"></script>
    <script src="src/streaming/vo/BitrateInfo.js"></script>
    <script src="src/streaming/vo/TrackInfo.js"></script>
    <script src="src/streaming/vo/MediaInfo.js"></script>
    <script src="src/streaming/vo/StreamInfo.js"></script>
    <script src="src/streaming/vo/ManifestInfo.js"></script>
    <script src="src/streaming/vo/Event.js"></script>
    <script src="src/streaming/vo/Error.js"></script>
    <script src="src/streaming/ManifestLoader.js"></script>
    <script src="src/streaming/ManifestUpdater.js"></script>
    <script src="src/streaming/models/ManifestModel.js"></script>
    <script src="src/streaming/extensions/MediaSourceExtensions.js"></script>
    <script src="src/streaming/extensions/SourceBufferExtensions.js"></script>
    <script src="src/streaming/extensions/VideoModelExtensions.js"></script>
    <script src="src/streaming/controllers/PlaybackController.js"></script>
    <script src="src/streaming/controllers/FragmentController.js"></script>
    <script src="src/streaming/controllers/AbrController.js"></script>
    <script src="src/streaming/FragmentLoader.js"></script>
    <script src="src/streaming/models/FragmentModel.js"></script>
    <script src="src/streaming/controllers/StreamController.js"></script>
    <script src="src/streaming/StreamProcessor.js"></script>
    <script src="src/streaming/controllers/ScheduleController.js"></script>
    <script src="src/streaming/TimeSyncController.js"></script>
    <script src="src/streaming/Stream.js"></script>
    <script src="src/streaming/controllers/BufferController.js"></script>
    <script src="src/streaming/LiveEdgeFinder.js"></script>
    <script src="src/streaming/Notifier.js"></script>
    <script src="src/streaming/controllers/EventController.js"></script>
    <script src="src/streaming/models/URIQueryAndFragmentModel.js"></script>
    <script src="src/streaming/vo/URIFragmentData.js"></script>

    <!--Protection-->
    <script src="src/streaming/models/ProtectionModel.js"></script>
    <script src="src/streaming/models/ProtectionModel_01b.js"></script>
    <script src="src/streaming/models/ProtectionModel_3Feb2014.js"></script>
    <script src="src/streaming/models/ProtectionModel_28Aug2014.js"></script>
    <script src="src/streaming/models/ProtectionModel_10Dec2014.js"></script>
    <script src="src/streaming/vo/protection/ClearKeyKeySet.js"></script>
    <script src="src/streaming/vo/protection/KeyPair.js"></script>
    <script src="src/streaming/vo/protection/SessionToken.js"></script>

    <script src="src/streaming/controllers/ProtectionController.js"></script>
    <script src="src/streaming/extensions/ProtectionExtensions.js"></script>
    <script src="src/streaming/protection/CommonEncryption.js"></script>

    <script src="src/streaming/protection/drm/KeySystem.js"></script>
    <script src="src/streaming/protection/drm/KeySystem_Access.js"></script>
    <script src="src/streaming/protection/drm/KeySystem_ClearKey.js"></script>
    <script src="src/streaming/protection/drm/KeySystem_PlayReady.js"></script>
    <script src="src/streaming/protection/drm/KeySystem_Widevine.js"></script>
    <script src="src/streaming/protection/drm/KeySystem.js"></script>

    <script src="src/streaming/vo/protection/KeyError.js"></script>
    <script src="src/streaming/vo/protection/KeyMessage.js"></script>
    <script src="src/streaming/vo/protection/LicenseRequestComplete.js"></script>
    <script src="src/streaming/vo/protection/NeedKey.js"></script>
    <script src="src/streaming/vo/protection/ProtectionData.js"></script>

    <!--Rules-->
    <script src="src/streaming/rules/SwitchRequest.js"></script>
    <script src="src/streaming/rules/RulesContext.js"></script>
    <script src="src/streaming/rules/RulesController.js"></script>

    <script src="src/streaming/rules/ABRRules/ArkenaSwitchingRule.js"></script>
    <script src="src/streaming/rules/ABRRules/DownloadRatioRule.js"></script>
    <script src="src/streaming/rules/ABRRules/InsufficientBufferRule.js"></script>
    <script src="src/streaming/rules/ABRRules/LimitSwitchesRule.js"></script>
    <script src="src/streaming/rules/ABRRules/ABRRulesCollection.js"></script>
    <script src="src/streaming/rules/ABRRules/BufferOccupancyRule.js"></script>
    <script src="src/streaming/rules/ABRRules/ThroughputRule.js"></script>

    <script src="src/streaming/rules/SchedulingRules/ScheduleRulesCollection.js"></script>
    <script src="src/streaming/rules/SchedulingRules/BufferLevelRule.js"></script>
    <script src="src/streaming/rules/SchedulingRules/PendingRequestsRule.js"></script>
    <script src="src/streaming/rules/SchedulingRules/SameTimeRequestRule.js"></script>
    <script src="src/streaming/rules/SchedulingRules/PlaybackTimeRule.js"></script>

    <script src="src/streaming/rules/SynchronizationRules/LiveEdgeBinarySearchRule.js"></script>
    <script src="src/streaming/rules/SynchronizationRules/LiveEdgeWithTimeSynchronizationRule.js"></script>
    <script src="src/streaming/rules/SynchronizationRules/SynchronizationRulesCollection.js"></script>

    <!--Captioning-->
    <script src="src/streaming/VTTParser.js"></script>
    <script src="src/streaming/TTMLParser.js"></script>
    <script src="src/streaming/TextSourceBuffer.js"></script>
    <script src="src/streaming/extensions/TextTrackExtensions.js"></script>
    <script src="src/streaming/controllers/TextController.js"></script>

    <!-- Metrics -->
    <script src="src/streaming/models/MetricsModel.js"></script>
    <script src="src/streaming/vo/MetricsList.js"></script>
    <script src="src/streaming/vo/metrics/BufferLevel.js"></script>
    <script src="src/streaming/vo/metrics/BufferState.js"></script>
    <script src="src/streaming/vo/metrics/HTTPRequest.js"></script>
    <script src="src/streaming/vo/metrics/PlayList.js"></script>
    <script src="src/streaming/vo/metrics/RepresentationSwitch.js"></script>
    <script src="src/streaming/vo/metrics/TCPConnection.js"></script>
    <script src="src/streaming/vo/metrics/DroppedFrames.js"></script>
    <script src="src/streaming/vo/metrics/SchedulingInfo.js"></script>
    <script src="src/streaming/vo/metrics/ManifestUpdate.js"></script>
    <script src="src/streaming/vo/metrics/DVRInfo.js"></script>

    <!-- Dash -->
    <script src="src/dash/Dash.js"></script>
    <script src="src/dash/DashContext.js"></script>
    <script src="src/dash/vo/Mpd.js"></script>
    <script src="src/dash/vo/Period.js"></script>
    <script src="src/dash/vo/AdaptationSet.js"></script>
    <script src="src/dash/vo/Representation.js"></script>
    <script src="src/dash/vo/Segment.js"></script>
    <script src="src/dash/vo/Event.js"></script>
    <script src="src/dash/vo/EventStream.js"></script>
    <script src="src/dash/vo/UTCTiming.js"></script>
    <script src="src/dash/DashParser.js"></script>
    <script src="src/dash/DashHandler.js"></script>
    <script src="src/dash/controllers/RepresentationController.js"></script>
    <script src="src/dash/extensions/BaseURLExtensions.js"></script>
    <script src="src/dash/extensions/FragmentExtensions.js"></script>
    <script src="src/dash/extensions/DashManifestExtensions.js"></script>
    <script src="src/dash/extensions/DashMetricsExtensions.js"></script>
    <script src="src/dash/TimelineConverter.js"></script>
    <script src="src/dash/DashAdapter.js"></script>

    <script type="text/javascript">
        init = function () {
            Hyddan.Player.initialize(new Dash.di.DashContext())
                            .configure({
                                autoPlay: true,
                                debug: {
                                    logToConsole: false
                                },
                                object: document.querySelector('.dash-video-player video'),
                                protection: {
                                    'com.microsoft.playready': {
                                        licenseRequest: {
                                            cdmData: null,
                                            laUrl: null,
                                            headers: null
                                        }
                                    },
                                    'com.widevine.alpha': {
                                        licenseRequest: {
                                            cdmData: null,
                                            laUrl: Hyddan.Utils.getQueryStringParameter('proxyUrl') || 'http://localhost:9900/proxy',
                                            headers: {
                                                'X-CustomData': JSON.stringify({
                                                    deviceId: 'SomeDeviceId',
                                                    providerType: 'SomeProviderType',
                                                    contentId: Hyddan.Utils.getQueryStringParameter('contentId') || 'SomeContentId',
                                                    optData: 'SomeToken'
                                                })
                                            }
                                        }
                                    }
                                },
                                source: Hyddan.Utils.getQueryStringParameter('url') || 'http://localhost/Playground/Dash/Manifest.mpd'
                            })
                            .volume(0.1)
                            .play()
							.rules([
								new MediaPlayer.rules.ArkenaSwitchingRule()
							]);
			console.log(Hyddan.Player.rules());
        };
    </script>
    <body onload="init()">
        <div class="dash-video-player">
            <video controls="true"></video>
        </div>
    </body>
</html>